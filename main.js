(()=>{"use strict";var e={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".btn-save",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"};function t(e,t,o,c){t.forEach((function(t){return n(e,t,c)})),r(t,o)}function n(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""}function r(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled")}var o=document.forms.formEdit,c=document.forms.formNewElement,i=o.querySelector(e.submitButtonSelector),u=document.querySelector(".info__name"),s=document.querySelector(".info__status"),a=document.querySelector("#profileName"),l=document.querySelector("#profileStatus"),d=document.querySelector("#popupEdit"),p=document.querySelector("#popupNewElement"),m=document.querySelector("#popupShowPhoto"),f=p.querySelector(e.submitButtonSelector),v=document.querySelector("#elementName"),y=document.querySelector("#elementLink");function S(e){e.classList.add("popup_opened")}function q(e){var t=document.querySelector(".popup_opened");"Escape"===e.key&&k(t)}function k(e){window.removeEventListener("keydown",q),e.classList.remove("popup_opened")}function _(e){k(e.target.closest(".popup"))}var E=document.querySelector(".elements__list"),b=document.querySelector("#card-template").content.querySelector(".element"),g=document.querySelector(".figure"),L=g.querySelector(".figure__image"),h=g.querySelector(".figure__caption"),w=document.querySelector("#popupShowPhoto");function x(e,t,n){var r=function(e,t){var n=b.cloneNode(!0),r=n.querySelector(".element__image"),o=n.querySelector(".element__title");r.setAttribute("alt",e),r.setAttribute("src",t),o.textContent=e;var c=n.querySelector(".btn-like");return c.addEventListener("click",(function(){c.classList.toggle("btn-like_liked")})),n.querySelector(".btn-trash").addEventListener("click",(function(e){e.target.closest(".element").remove()})),r.addEventListener("click",(function(n){L.setAttribute("alt",e),L.setAttribute("src",t),h.textContent=e,window.addEventListener("keydown",q),S(w)})),n}(e,t);"append"===n?E.append(r):E.prepend(r)}var C=document.querySelector(".btn-edit"),A=document.querySelector(".btn-add");C.addEventListener("click",(function(n){a.value=u.textContent,l.value=s.textContent,t(d,[a,l],i,e),window.addEventListener("keydown",q),S(d)})),o.addEventListener("submit",(function(e){e.preventDefault(),u.textContent=a.value,s.textContent=l.value,_(e)})),c.addEventListener("submit",(function(e){e.preventDefault(),x(v.value,y.value),e.target.reset(),_(e)})),[d,p,m].forEach((function(e){e.addEventListener("click",(function(e){(!e.target.className.includes("form")&&!e.target.className.includes("figure")||e.target.classList.contains("popup__container"))&&_(e)}))})),[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((function(e){x(e.name,e.link,"append")})),A.addEventListener("click",(function(){c.reset(),t(p,[v,y],f,e),window.addEventListener("keydown",q),S(p)})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var o=Array.from(e.querySelectorAll(t.inputSelector)),c=e.querySelector(t.submitButtonSelector);o.forEach((function(i){i.addEventListener("input",(function(){r(o,c),function(e,t,r){t.validity.valid?n(e,t,r):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r.inputErrorClass),t.validity.patternMismatch?o.textContent=t.dataset.errorMessage:o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,r)}(e,i,t)}))}))}(t,e)}))}(e)})();